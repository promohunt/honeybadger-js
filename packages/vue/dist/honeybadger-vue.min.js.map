{"version":3,"file":"honeybadger-vue.min.js","sources":["../../src/vue-debug.js","../../src/error-logging.js","../../src/index.js"],"sourcesContent":["/**\n * This was originally taken from https://github.com/vuejs/vue/blob/master/src/core/util/debug.js.\n * The method generateStackTrace is used to log errors the same way as Vue logs them when errorHandler is not set.\n */\n\nconst classifyRE = /(?:^|[-_])(\\w)/g\nconst classify = str => str\n  .replace(classifyRE, c => c.toUpperCase())\n  .replace(/[-_]/g, '')\n\nconst ANONYMOUS_COMPONENT = '<Anonymous>'\nconst ROOT_COMPONENT = '<Root>'\n\nconst formatComponentName = (vm, includeFile, isVue3Vm) => {\n  if (!vm) {\n    return ANONYMOUS_COMPONENT\n  }\n\n  // no need to check for root in vue3, better to show name of component, even if $root\n  if (!isVue3Vm && vm.$root === vm) {\n    return ROOT_COMPONENT\n  }\n\n  const options = vm.$options\n  if (!options) {\n    return ANONYMOUS_COMPONENT\n  }\n\n  // __name found in vue3\n  let name = options.name || options._componentTag || options.__name\n  const file = options.__file\n  if (!name && file) {\n    const match = file.match(/([^/\\\\]+)\\.vue$/)\n    name = match && match[1]\n  }\n\n  return (\n    (name ? `<${classify(name)}>` : ANONYMOUS_COMPONENT) +\n    (file && includeFile !== false ? ` at ${file}` : '')\n  )\n}\n\nconst repeat = (str, n) => {\n  let res = ''\n  while (n) {\n    if (n % 2 === 1) res += str\n    if (n > 1) str += str\n    n >>= 1\n  }\n  return res\n}\n\nconst isVue3Vm = vm => !!(vm && vm.__isVue)\nconst isVue2Vm = vm => !!(vm && vm._isVue)\n\nexport const generateComponentTrace = vm => {\n  const vue3Vm = isVue3Vm(vm)\n  if ((vue3Vm || isVue2Vm(vm)) && vm.$parent) {\n    const tree = []\n    let currentRecursiveSequence = 0\n    while (vm) {\n      if (!vue3Vm && tree.length > 0) {\n        const last = tree[tree.length - 1]\n        if (last.constructor === vm.constructor) {\n          currentRecursiveSequence++\n          vm = vm.$parent\n          continue\n        } else if (currentRecursiveSequence > 0) {\n          tree[tree.length - 1] = [last, currentRecursiveSequence]\n          currentRecursiveSequence = 0\n        }\n      }\n      tree.push(vm)\n      vm = vm.$parent\n    }\n    return '\\n\\nfound in\\n\\n' + tree\n      .map((vm, i) => `${\n        i === 0 ? '---> ' : repeat(' ', 5 + i * 2)\n      }${\n        Array.isArray(vm)\n          ? `${formatComponentName(vm[0], true, vue3Vm)}... (${vm[1]} recursive calls)`\n          : formatComponentName(vm, true, vue3Vm)\n      }`)\n      .join('\\n')\n  } else {\n    return `\\n\\n(found in ${formatComponentName(vm, true, vue3Vm)})`\n  }\n}\n","import { generateComponentTrace } from './vue-debug'\n\nexport function logError (app, error, vm, info) {\n  const message = `Error in ${info}: \"${error && error.toString()}\"`\n\n  const trace = vm ? generateComponentTrace(vm) : ''\n  if (app.config.warnHandler) {\n    app.config.warnHandler.call(null, message, vm, trace)\n  } else {\n    console.error(`[Vue warn]: ${message}${trace}`)\n  }\n}\n","import Honeybadger from '@honeybadger-io/js'\nimport { logError } from './error-logging'\n\nconst NOTIFIER = {\n  name: '@honeybadger-io/vue',\n  url: 'https://github.com/honeybadger-io/honeybadger-js',\n  version: '__VERSION__'\n}\n\nfunction shouldLogError (app, options) {\n  if (app.config.warnHandler) {\n    return true\n  }\n\n  const hasConsole = typeof console !== 'undefined'\n  const hasProcess = typeof process !== 'undefined'\n  const isDebug = options.debug || (hasProcess && process.env.NODE_ENV !== 'production')\n  return hasConsole && isDebug\n}\n\nfunction extractContext (vm) {\n  const options = vm.$options || {}\n  const name = options.name || options._componentTag\n  const file = options.__file\n  const parentName = vm.$parent && vm.$parent.$options ? vm.$parent.$options.name : undefined\n\n  // Vue2 - $options.propsData\n  // Vue3 - $props\n  const props = options.propsData || vm.$props\n\n  return {\n    isRoot: vm.$root === vm,\n    name: name,\n    props,\n    parentName: parentName,\n    file: file\n  }\n}\n\nfunction install(vue, options) {\n  if (options.debug) {\n    console.log(`Honeybadger configured with ${options.apiKey}`)\n  }\n  const honeybadger = Honeybadger.configure(options)\n  honeybadger.setNotifier(NOTIFIER)\n\n  vue.$honeybadger = honeybadger\n\n  // vue 2 support -> make available for all components\n  if (vue.prototype) {\n    vue.prototype.$honeybadger = honeybadger\n  }\n\n  if (vue.config && vue.config.globalProperties) {\n    // vue 3 support -> make available for all components\n    vue.config.globalProperties.$honeybadger = honeybadger\n  }\n  const chainedErrorHandler = vue.config.errorHandler\n  vue.config.errorHandler = (error, vm, info) => {\n    const metadata = { context: { vm: extractContext(vm), info: info } }\n    honeybadger.notify(error, metadata)\n    if (typeof chainedErrorHandler === 'function') {\n      chainedErrorHandler.call(vue, error, vm, info)\n    }\n\n    if (shouldLogError(vue, options)) {\n      logError(vue, error, vm, info)\n    }\n  }\n}\n\nexport default {\n  install\n}\n"],"names":["classifyRE","ANONYMOUS_COMPONENT","formatComponentName","vm","includeFile","isVue3Vm","$root","const","options","$options","let","name","_componentTag","__name","file","__file","match","replace","c","toUpperCase","logError","app","error","info","message","toString","trace","vue3Vm","__isVue","_isVue","isVue2Vm","$parent","tree","currentRecursiveSequence","length","last","constructor","push","map","i","str","n","res","repeat","Array","isArray","join","generateComponentTrace","config","warnHandler","call","console","NOTIFIER","url","version","extractContext","parentName","undefined","props","propsData","$props","isRoot","index","install","vue","debug","log","honeybadger","Honeybadger","configure","setNotifier","$honeybadger","prototype","globalProperties","chainedErrorHandler","errorHandler","metadata","context","notify","hasConsole","hasProcess","process","isDebug","env","NODE_ENV","shouldLogError"],"mappings":"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"}